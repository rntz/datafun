\documentclass[xcolor={dvipsnames}]{beamer}

\usefonttheme{serif}
\usepackage[pteuler]{rntzfont} % pteuler, charter work well
%\usepackage{PTSans}
\usepackage[semibold]{sourcesanspro}

%\usepackage{booktabs}
\usepackage{anyfontsize} % fix font warnings from stmaryrd
\usepackage{latexsym,amssymb,stmaryrd,mathtools}
\usepackage{mathpartir}
\usepackage{multirow}
\usepackage{tikz,tikz-cd}       % Hasse & commutative diagrams.
\usepackage{url,hyperref}
\usepackage{nccmath}

\usepackage[normalem]{ulem}               % for \sout
\newcommand{\msout}[1]{\text{\sout{\ensuremath{#1}}}}

\definecolor[named]{ACMBlue}{cmyk}{1,0.1,0,0.1}
\definecolor[named]{ACMYellow}{cmyk}{0,0.16,1,0}
\definecolor[named]{ACMOrange}{cmyk}{0,0.42,1,0.01}
\definecolor[named]{ACMRed}{cmyk}{0,0.90,0.86,0}
\definecolor[named]{ACMLightBlue}{cmyk}{0.49,0.01,0,0}
\definecolor[named]{ACMGreen}{cmyk}{0.20,0,1,0.19}
\definecolor[named]{ACMPurple}{cmyk}{0.55,1,0,0.15}
\definecolor[named]{ACMDarkBlue}{cmyk}{1,0.58,0,0.21}

\title{A type system for monotonicity}
\author{Michael Arntzenius}
\institute{University of Birmingham}
\date{ICFP 2018}


%% ===== Commands =====
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\x}{\times}
\newcommand{\G}{\Gamma}
\newcommand{\fn}{\lambda}
\newcommand{\binder}{.~}
\newcommand{\bind}[1]{{#1}\binder}
\newcommand{\fnof}[1]{\fn\bind{#1}}
\newcommand{\den}[1]{\llbracket{#1}\rrbracket}
\newcommand{\bnfeq}{\dblcolon=}
\newcommand{\hilit}{\color{Rhodamine}}
\newcommand{\hil}[1]{{\hilit#1}}

\newcommand{\rulename}{\sffamily\scshape}

\newcommand\opcolor{\color{ForestGreen}}
\newcommand\isocolor{\color{NavyBlue}}

\newcommand{\id}{\text{id}}
\newcommand{\op}{{\text{\opcolor op}}}
\newcommand{\iso}{\ensuremath{{\isocolor\Box}}}
\renewcommand{\path}{\ensuremath{\lozenge}}

\newcommand{\idof}{\mathop{\id}}
\newcommand{\opof}{\mathop{\op}}
\newcommand{\isof}{\iso}
\newcommand{\pathof}{\path}

\newcommand\subtype{\mathrel{<:}}
\newcommand\fname[1]{\ensuremath{\mathrm{#1}}}
\newcommand\kw[1]{\mathbf{#1}}
\newcommand\isovar[1]{{#1}}


\begin{document}
\maketitle
\Large

\begin{frame}{}
  \LARGE
  It's just the simply-typed $\lambda$-calculus!
  \[\begin{array}{rcll}
    \den{A} &\in& \mathbf{Poset}\vspace{.2em}\\
    {\den{A \to B}}
    &=& \text{\emph{monotone} maps}~ \den{A} \to \den{B},\\
    && \text{ordered pointwise}
  \end{array}\]
\end{frame}

\begin{frame}
  \vspace{-2em}
  \begin{mathpar}
    \begin{tikzpicture}[baseline=(current bounding box.center)]
      \node (a) at (-0.5, 0) {a};
      \node (b) at (0, 1.33) {b};
      \node (c) at (.5, 0) {c};
      %% bounding box
      \node [above] at (0, 2) {$A$};
      \draw (-1, 1.83) -- (1, 1.83) -- (1, -0.5) -- (-1, -0.5) -- cycle;
      %% arrows
      \draw [-{Latex[width=2mm]}] (a) -- (b);
      \draw [-{Latex[width=2mm]}] (c) -- (b);
    \end{tikzpicture}

    \begin{tikzpicture}[baseline=(current bounding box.center)]
      \node (a) at (-0.5, 0) {a};
      \node (b) at (0, 1.33) {b};
      \node (c) at (.5, 0) {c};
      %% bounding box
      \node [above] at (0, 2) {$\opof A$};
      \draw (-1, 1.83) -- (1, 1.83) -- (1, -0.5) -- (-1, -0.5) -- cycle;
      %% arrows
      \draw [{Latex[width=2mm]}-] (a) -- (b);
      \draw [{Latex[width=2mm]}-] (c) -- (b);
    \end{tikzpicture}

    \begin{tikzpicture}[baseline=(current bounding box.center)]
      \node (a) at (-0.5, 0) {a};
      \node (b) at (0, 1.33) {b};
      \node (c) at (.5, 0) {c};
      %% bounding box
      \node [above] at (0, 2) {$\isof A$};
      \draw (-1, 1.83) -- (1, 1.83) -- (1, -0.5) -- (-1, -0.5) -- cycle;
    \end{tikzpicture}
  \end{mathpar}
  \vspace{1em}

  %\pause
  $f : \isof A \to B$ is monotone iff
  \begin{center}
    $x = y \implies f(x) \le f(y)$
  \end{center}
  i.e. \textbf{always}!
\end{frame}

%% TODO: subtractEach?

\begin{frame}
  \[\begin{array}{l}
  \fname{setMap} ~:~
  \iso(\iso A \to B) \to \fname{Set}~A \to \fname{Set}~B\\
  \fname{setMap}~f~xs =\\
  \alt<2>{}{\quad\kw{let}~\kw{box}~\isovar{g} = f ~\kw{in}}{}\\
  \quad\kw{do}~x \leftarrow xs\\
  \alt<2>{}{\quad\phantom{\kw{do}~}\kw{let}~\kw{box}~\isovar{y} = x}\\
  \quad\phantom{\kw{do}~}
  \fname{return}~
  \uncover<1>{(\kw{box}~}
  (\alt<2>{f\hspace{2.1pt}}{g}~
  \uncover<1>{(\kw{box}~}\alt<1>{\isovar{y}}{x})\uncover<1>{))}
  \end{array}\]
\end{frame}

\end{document}
